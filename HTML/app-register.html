<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>S'inscrire</title>
    <meta name="description" content="Orion invest , investir c'est grandir">
    <meta name="keywords"
        content="Orion fiance app" />
    <link rel="icon" type="image/png" href="assets/img/favicon.png" sizes="32x32">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/icon/192x192.png">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="manifest" href="__manifest.json">
</head>

<body>

    <!-- loader -->
    <div id="loader">
        <img src="assets/img/loading-icon.png" alt="icon" class="loading-icon">
    </div>
    <!-- * loader -->

    <!-- App Header -->
    <div class="appHeader no-border transparent position-absolute">
        <div class="left">
            <a href="#" class="headerButton goBack">
                <ion-icon name="chevron-back-outline"></ion-icon>
            </a>
        </div>
        <div class="pageTitle"></div>
        <div class="right">
            <a href="app-login.html" class="headerButton">
                Se connecter
            </a>
        </div>
    </div>
    <!-- * App Header -->

    <!-- App Capsule -->
    <div id="appCapsule">
        
        <div class="section mt-2 text-center">

            <div class="mb-1">
                <img src="assets/img/sample/photo/33.png" alt="image" class="imaged w140">
            </div>

            <h1>S'inscrire maintenant</h1>
            <h4>Cr√©er un compte</h4>
        </div>
        <div class="section mb-5 p-2">
            <form id="registerForm">
                <div class="card">
                    <div class="card-body">
                        <!-- Nom -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="name">Nom</label>
                                <input type="text" class="form-control" id="name" placeholder="Votre nom">
                            </div>
                        </div>
                
                        <!-- E-mail -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="email">E-mail</label>
                                <input type="email" class="form-control" id="email" placeholder="Votre e-mail">
                            </div>
                        </div>
                
                        <!-- Num√©ro de t√©l√©phone avec choix de pays -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="phone">Num√©ro de t√©l√©phone</label>
                                <div class="d-flex">
                                    <select class="form-control" id="countryCode">
                                        <option value="+241">üá¨üá¶ Gabon (+241)</option>
                                        <option value="+224">üá¨üá≥ Guin√©e (+224)</option>
                                        <option value="+221">üá∏üá≥ S√©n√©gal (+221)</option>
                                        <option value="+225">üá®üáÆ C√¥te d'Ivoire (+225)</option>
                                        <option value="+237">üá®üá≤ Cameroun (+237)</option>
                                    </select>
                                    <input type="tel" class="form-control" id="phone" placeholder="Votre num√©ro">
                                </div>
                            </div>
                        </div>
                
                        <!-- Mot de passe -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="password">Mot de passe</label>
                                <input type="password" class="form-control" id="password" placeholder="Votre mot de passe">
                            </div>
                        </div>
                
                        <!-- Confirmation du mot de passe -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="confirmPassword">Confirmer le mot de passe</label>
                                <input type="password" class="form-control" id="confirmPassword" placeholder="Confirmez votre mot de passe">
                            </div>
                        </div>
                
                        <!-- Code d'adh√©sion -->
                        <div class="form-group basic">
                            <div class="input-wrapper">
                                <label class="label" for="membershipCode">Code d'adh√©sion</label>
                                <input type="text" class="form-control" id="membershipCode" placeholder="Votre code d'adh√©sion">
                            </div>
                        </div>
                
                        <!-- Conditions g√©n√©rales -->
                        <div class="form-check mt-2 mb-1">
                            <input type="checkbox" class="form-check-input" id="terms">
                            <label class="form-check-label" for="terms">
                                J'accepte <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">les termes et conditions</a>
                            </label>
                        </div>
                    </div>
                </div>



                <div class="form-button-group transparent">
                    <button type="submit" class="btn btn-primary btn-block btn-lg">S'inscrire</button>
                </div>

            </form>
        </div>

    </div>
    <!-- * App Capsule -->
<!-- Modal -->
<!--Component Dialog-->
<div class="modal fade dialogbox" id="alertModal" data-bs-backdrop="static" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-icon" id="alertModalIcon">
                <ion-icon name="information-circle"></ion-icon>
            </div>
            <div class="modal-header">
                <h5 class="modal-title" id="alertModalTitle">Info</h5>
            </div>
            <div class="modal-body" id="alertModalMessage">Ceci est un message d'information.</div>
            <div class="modal-footer">
                <div class="btn-inline">
                    <a href="#" class="btn" data-bs-dismiss="modal">FERMER</a>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Component Dialog-->


    <!-- Terms Modal -->
    <div class="modal fade modalbox" id="termsModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Termes et Conditions</h5>
                    <a href="#" data-bs-dismiss="modal">Close</a>
                </div>
                <div class="modal-body">
                    <p>
                        En investissant dans Orion Invest, vous acceptez de placer votre argent dans des projets
                        sp√©cifiques tout en acqu√©rant des parts en tant qu'investisseur. 
                        Ce choix refl√®te votre engagement √† contribuer au d√©veloppement des initiatives port√©es par Orion Invest,
                        tout en esp√©rant une croissance significative de votre capital. 
                        L'application s'engage, dans la mesure du possible, √† optimiser la gestion des fonds pour garantir 
                        une √©volution favorable de vos investissements durant la p√©riode d√©finie pour chaque projet.
                    </p>
                    <p>
                        Toutefois, il est essentiel de comprendre que tout investissement comporte des risques.
                        Orion Invest ne peut garantir un succ√®s absolu ou une rentabilit√© certaine des projets dans lesquels
                        vous choisissez d'investir. Les performances financi√®res d√©pendent de nombreux facteurs, 
                        dont certains √©chappent au contr√¥le de l'application ou de ses gestionnaires. Par cons√©quent, 
                        en cas de perte partielle ou totale de votre investissement, Orion Invest d√©cline toute responsabilit√©.
                        Vous reconnaissez qu'en investissant, vous acceptez ce risque de mani√®re volontaire et √©clair√©e.
                    </p>
                    <p>
                        Orion Invest met tout en ≈ìuvre pour choisir des projets √† fort potentiel et pour accompagner chaque 
                        initiative avec soin et expertise. Cependant, il est important de rappeler que le march√© de l'investissement
                        est soumis √† des impr√©vus, des fluctuations √©conomiques et des al√©as propres √† chaque secteur d'activit√©.
                        Ces √©l√©ments peuvent affecter la rentabilit√© des projets et, par cons√©quent, la croissance de vos fonds.
                    </p>
                    <p>
                        En rejoignant Orion Invest, vous affirmez avoir pris connaissance de ces conditions et les accepter.
                        Vous comprenez que votre engagement en tant qu'investisseur repose sur une prise de risque calcul√©e
                        et que vous seul(e) √™tes responsable de votre d√©cision d'investir. Nous vous encourageons √† bien √©valuer
                        chaque opportunit√© et, si n√©cessaire, √† consulter un conseiller financier avant de vous engager.
                    </p>
                    <p>
                        Chez Orion Invest, notre objectif est de vous accompagner au mieux dans votre parcours d'investissement,
                        tout en vous offrant des opportunit√©s de croissance. Nous restons disponibles pour r√©pondre √† toutes vos
                        questions et vous fournir des informations transparentes sur les projets dans lesquels vous investissez.
                    </p>
                    
                </div>
            </div>
        </div>
    </div>
    <!-- * Terms Modal -->


    <!-- ========= JS Files =========  -->
    <!-- Bootstrap -->
    <script src="assets/js/lib/bootstrap.bundle.min.js"></script>
    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <!-- Splide -->
    <script src="assets/js/plugins/splide/splide.min.js"></script>
    <!-- Base Js File -->
    <script src="assets/js/base.js"></script>

    <!-- Script de l'api-->
     <!-- 674895876 -->
    <script>
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault(); // Emp√™che la redirection par d√©faut



    document.addEventListener("DOMContentLoaded", function() {
    // Fonction pour r√©cup√©rer un param√®tre d'URL par son nom
    function getUrlParameter(name) {
        const regex = new RegExp('[?&]' + name + '=([^&#]*)');
        const results = regex.exec(window.location.href);
        if (results === null) {
            return null;  // Si le param√®tre n'est pas trouv√©, retourne null
        } else {
            return decodeURIComponent(results[1].replace(/\+/g, ' '));  // D√©codage du param√®tre
        }
    }

    // R√©cup√©rer la valeur de 'userReferralCode' depuis l'URL
    const userReferralCode = getUrlParameter('userReferralCode');
    
    // V√©rification dans la console
    console.log("Code de parrainage r√©cup√©r√© :", userReferralCode); // Log pour voir la valeur r√©cup√©r√©e

    // Si un code est trouv√© dans l'URL, le placer dans le champ de texte
    if (userReferralCode) {
        const inputField = document.getElementById('membershipCode');
        
        // V√©rification de la pr√©sence du champ
        if (inputField) {
            inputField.value = userReferralCode;
            console.log("Le code d'adh√©sion a √©t√© ins√©r√© dans le champ."); // Log pour v√©rifier que l'input a √©t√© modifi√©
        } else {
            console.log("Erreur : champ d'entr√©e non trouv√©.");
        }
    } else {
        console.log("Aucun code de parrainage trouv√© dans l'URL.");
    }
});



            // R√©cup√©rer les donn√©es saisies dans le formulaire
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const countryCode = document.getElementById('countryCode').value.trim();
            const phone_number = document.getElementById('phone').value.trim();
            const password = document.getElementById('password').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            const referrer_code = document.getElementById('membershipCode').value.trim();
            const termsAccepted = document.getElementById('terms').checked;
    
            // Validation de base
            if (!name || !email || !phone_number || !password || !confirmPassword || !termsAccepted) {
                showAlert('info',`Veuillez remplir tous les champs et accepter les termes et conditions.`);

                return;
            }
            if (password !== confirmPassword) {
                showAlert('info',`Les mots de passe ne correspondent pas.`);

                return;
            }
    
            // Construire le corps de la requ√™te
            const data = {
                name,
                email,
                phone_number,
                password,
                referrer_code,
            };
    
            try {
                // Envoyer les donn√©es √† l'API via une requ√™te POST
                const response = await fetch('https://lionfish-app-54bdv.ondigitalocean.app/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    'Access-Control-Allow-Origin': '*', // Permet d'indiquer l'origine autoris√©e, bien que ce soit g√©r√© c√¥t√© serveur
                    'Access-Control-Allow-Methods': 'GET, POST, OPTIONS', // M√©thodes permises, aussi c√¥t√© serveur
                    body: JSON.stringify(data),
                });
    
                // G√©rer la r√©ponse
                const result = await response.json();
                if (response.ok) {

                    showAlert('Succ√®s',`Inscription r√©eussi avec succ√®s`);
                    // Rediriger l'utilisateur apr√®s 2 secondes (ou toute autre dur√©e que vous pr√©f√©rez)
                    setTimeout(() => {
                     window.location.href = 'app-login.html';
                    }, 3000); // Temps en millisecondes, ici 2000ms = 2 secondes
                    }

                                else {
                                    showAlert('error',`Un probl√®me est survenu , veuillez r√©essayer`);

            }

            } catch (error) {
                console.error("Erreur lors de l'envoi des donn√©es :", error);
                showAlert('error',`Erreur : ${error.message}`);
            }

        });

/**
 * Fonction pour Message d'alerte
 */
 function showAlert(type, message) {
    // S√©lectionner les √©l√©ments de la modal
    const modalTitle = document.getElementById('alertModalTitle');
    const modalMessage = document.getElementById('alertModalMessage');
    const modalIcon = document.getElementById('alertModalIcon');

    // Personnaliser la modal en fonction du type
    switch (type) {
        case 'success':
            modalTitle.textContent = 'Succ√®s';
            modalMessage.textContent = message;
            modalIcon.innerHTML = '<ion-icon name="checkmark-circle"></ion-icon>';
            modalIcon.className = 'modal-icon text-success';
            break;

        case 'error':
            modalTitle.textContent = 'Erreur';
            modalMessage.textContent = message;
            modalIcon.innerHTML = '<ion-icon name="alert-circle"></ion-icon>';
            modalIcon.className = 'modal-icon text-danger';
            break;

        case 'info':
        default:
            modalTitle.textContent = 'Info';
            modalMessage.textContent = message;
            modalIcon.innerHTML = '<ion-icon name="information-circle"></ion-icon>';
            modalIcon.className = 'modal-icon text-primary';
            break;
    }

    // Afficher la modal
    const modal = new bootstrap.Modal(document.getElementById('alertModal'));
    modal.show();
}

    </script>
    


</body>

</html>